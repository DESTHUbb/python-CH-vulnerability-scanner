import re
import sys
nmap_log = open(sys.argv[1]).readlines()
ip_re = r"([0-9]{1,3}\.){3}[0-9]{1,3}"
port_re = r"([0-9]{2,5})\/open"
for log in nmap_log:
    ip= re.compile(ip_re).search(log)
    ports=re.compile(port_re).findall(log)
    if ip and ports:
        for p in ports:
            print("%s:%s"%(ip.group(),p))

/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

# Script improvement:

import re
import sys

def main():
    ip_re = r"([0-9]{1,3}\.){3}[0-9]{1,3}"
    port_re = r"([0-9]{2,5})/open"
    
      if len(sys.argv) < 2:
        print("Uso: python script.py <archivo_log_nmap>")
        sys.exit(1)
